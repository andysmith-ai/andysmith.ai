#!/bin/bash
# Convert ASCII art to PNG image using pango-view
#
# Usage:
#   ascii2png output.png < input.txt
#   ascii2png -bg "#1a1a2e" -fg "#e0e0e0" output.png < input.txt
#   cat art.txt | ascii2png -fs 28 output.png
#
# Options:
#   -bg COLOR    Background color (default: #1a1a2e)
#   -fg COLOR    Foreground/text color (default: #e0e0e0)
#   -fs SIZE     Font size (default: 28)
#   -m  MARGIN   Margin in pixels (default: 40)

bg="#1a1a2e"
fg="#e0e0e0"
fs=28
margin=80
output=""

while [[ $# -gt 0 ]]; do
    case $1 in
        -bg) bg="$2"; shift 2 ;;
        -fg) fg="$2"; shift 2 ;;
        -fs) fs="$2"; shift 2 ;;
        -m)  margin="$2"; shift 2 ;;
        *) output="$1"; shift ;;
    esac
done

if [[ -z "$output" ]]; then
    echo "Usage: ascii2png [options] output.png" >&2
    exit 1
fi

tmp=$(mktemp)
cat > "$tmp"
pango-view --font="DejaVu Sans Mono $fs" --background="$bg" --foreground="$fg" --margin="$margin" -qo "$output" "$tmp"
rm "$tmp"
